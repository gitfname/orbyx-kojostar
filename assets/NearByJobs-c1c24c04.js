import{r as c,j as e,i as u}from"./index-d8fa4cee.js";import{b as f,L as h,D as m,C as p}from"./App-8c327c57.js";import{s as y}from"./search-da0d918e.js";import{u as b}from"./useSearchParams-3c830439.js";import{u as j}from"./chunk-ENIANY67-29a1425c.js";async function N({category_id:a,city_ids:n,key:s,lat:i,lng:o}){return await y({type:2,key:s,city_id:n,category_id:a,lat:i,lng:o})}function E(){const[a,n]=c.useState(void 0),[s,i,o]=b(t=>[t.data.key,t.data.category_id,t.data.city_id]),r=j(),{data:d,error:g,isLoading:l,mutate:x}=f("/search/near-by",async()=>await N({category_id:i,city_ids:o,key:s,lat:(a==null?void 0:a.lat)||35.7219,lng:(a==null?void 0:a.lng)||51.3347}),{shouldRetryOnError:!0,errorRetryInterval:4e3,revalidateOnFocus:!1});return c.useEffect(()=>{x()},[s,o,i,a==null?void 0:a.lat,a==null?void 0:a.lng]),c.useEffect(()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({lat:t.coords.latitude,lng:t.coords.longitude})},t=>{switch(t.code){case t.TIMEOUT:r({description:"مشکلی رخ داد. به اینترنت متصل هستین ؟",position:"top-right",duration:3e3,status:"error"});break;case t.PERMISSION_DENIED:r({description:"لطفا مجوز دسترسی به gps را به این وب اپ بدهید",position:"top-right",duration:3e3,status:"error"});break;case t.POSITION_UNAVAILABLE:r({description:"مشکلی هنگام دریافت موقعیت رخ داد. بعدا دوباره امتحان کنید",position:"top-right",duration:3e3,status:"error"});break;default:r({description:"مشکلی رخ داد. بعدا دوباره امتحان کنید",position:"top-right",duration:3e3,status:"error"});break}})},[]),l?e.jsx(h,{}):g?e.jsx("p",{children:"something went wrong"}):e.jsxs("div",{className:"w-full h-max",children:[e.jsxs("p",{children:[a==null?void 0:a.lat," + ",a==null?void 0:a.lng]}),e.jsx(m,{containerClassName:"grid grid-cols-1 md:grid-cols-2 gap-6",title:"",dataProvider:d==null?void 0:d.data,dataRenderer:t=>e.jsx(p,{title:t.title,category:t.category,address:t.address,city:t.city,discount:t.discount,id:t.id,image:t.image,lat:t.lat,lng:t.lng,rate:t.rate,rate_count:t.rate_count,link:u()+"/jobs/"+t.id},t.id),emptyFallback:e.jsxs("div",{className:"w-full p-10 grid place-items-center",children:[e.jsx("img",{alt:"no data",src:u()+"/images/noItem.png",className:"w-28 h-auto border border-purple-600 inline-block"}),e.jsx("p",{className:"text-sm text-slate-800 font-[vazirMedium] mt-3.5",children:"هیچ موردی وجود ندارد"})]}),loading:e.jsx("div",{className:"w-full h-72 grid place-items-center",children:e.jsxs("div",{className:`p-4 px-6 rounded-2xl flex flex-col items-center justify-center gap-y-5 bg-blue-500/80\r
            shadow-lg shadow-black/5`,children:[e.jsx("p",{className:"text-base text-slate-50 font-[vazir]",children:"درحال لود"}),e.jsx("div",{className:"w-10 h-10 border-t border-t-white rounded-full animate-spin"})]})}),isLoading:l})]})}export{E as default};
